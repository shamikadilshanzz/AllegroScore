(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{3622:(e,t,r)=>{Promise.resolve().then(r.bind(r,7688))},3982:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});let i=(0,r(157).A)("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]])},4717:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var i=r(4477);let a=(0,i.createServerReference)("406fa3e4455bb61e1ba14699a875f2d259d04a36aa",i.callServer,void 0,i.findSourceMapURL,"getPurchasedMusic")},5096:(e,t,r)=>{"use strict";r.d(t,{L:()=>u});var i=r(5155),a=r(6766),s=r(6874),n=r.n(s),o=r(6695),l=r(6126),c=r(8817);function d(e){var t;let{item:r}=e,s=c.G.find(e=>e.id===r.imageId),d="number"==typeof r.price?r.price:0;return(0,i.jsx)(n(),{href:"/sheet-music/".concat(r.id),className:"group",children:(0,i.jsxs)(o.Zp,{className:"h-full overflow-hidden transition-all duration-300 hover:shadow-lg hover:shadow-primary/20 hover:border-primary/50",children:[(0,i.jsx)(o.aR,{className:"p-0",children:(0,i.jsx)("div",{className:"aspect-[3/4] overflow-hidden",children:(0,i.jsx)(a.default,{src:null!=(t=null==s?void 0:s.imageUrl)?t:"https://picsum.photos/seed/placeholder/600/800",alt:r.title,width:600,height:800,className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-105","data-ai-hint":null==s?void 0:s.imageHint})})}),(0,i.jsxs)(o.Wu,{className:"p-4",children:[(0,i.jsx)(o.ZB,{className:"text-lg font-headline leading-tight",children:r.title}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:r.composer})]}),(0,i.jsxs)(o.wL,{className:"p-4 pt-0 flex justify-between items-center",children:[(0,i.jsx)(l.E,{variant:"secondary",children:r.instrument}),(0,i.jsxs)("p",{className:"font-semibold text-lg text-primary",children:["$",d.toFixed(2)]})]})]})})}function u(e){let{items:t}=e;return 0===t.length?(0,i.jsxs)("div",{className:"text-center text-muted-foreground py-16",children:[(0,i.jsx)("p",{className:"text-lg",children:"No sheet music found."}),(0,i.jsx)("p",{children:"Try adjusting your filters."})]}):(0,i.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(e=>(0,i.jsx)(d,{item:e},e.id))})}},5695:(e,t,r)=>{"use strict";var i=r(8999);r.o(i,"notFound")&&r.d(t,{notFound:function(){return i.notFound}}),r.o(i,"useParams")&&r.d(t,{useParams:function(){return i.useParams}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}})},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var i=r(5155);r(2115);var a=r(2085),s=r(9434);let n=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...a}=e;return(0,i.jsx)("div",{className:(0,s.cn)(n({variant:r}),t),...a})}},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>o,wL:()=>u});var i=r(5155),a=r(2115),s=r(9434);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},7688:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var i=r(5155),a=r(5096),s=r(4717),n=r(3982),o=r(9576),l=r(5695),c=r(2115);function d(){let{user:e,loading:t}=(0,o.A)(),r=(0,l.useRouter)(),[d,u]=(0,c.useState)([]),[p,f]=(0,c.useTransition)();return((0,c.useEffect)(()=>{t||null!==e||r.push("/login"),e&&f(async()=>{u(await (0,s.n)(e.purchaseHistory))})},[e,t,r]),t||!e)?(0,i.jsx)("div",{className:"container mx-auto px-4 py-8 text-center",children:(0,i.jsx)("p",{children:"Loading..."})}):(0,i.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,i.jsx)(n.A,{className:"w-8 h-8 text-primary"}),(0,i.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"My Library"})]}),(0,i.jsx)("p",{className:"text-muted-foreground mb-8",children:"All your purchased sheet music in one place."}),p?(0,i.jsx)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:(0,i.jsx)("p",{children:"Loading your library..."})}):d.length>0?(0,i.jsx)(a.L,{items:d}):(0,i.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold",children:"Your library is empty"}),(0,i.jsx)("p",{className:"text-muted-foreground mt-2",children:"Start browsing to find your next piece!"})]})]})}},8817:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});let i=JSON.parse('{"o":[{"id":"1","description":"Moonlit piano keys","imageUrl":"https://images.unsplash.com/photo-1635476573973-fdb06ca7ad4d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpYW5vJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"piano music"},{"id":"2","description":"Violin resting on a score","imageUrl":"https://images.unsplash.com/photo-1701749059090-ac8afdba7b44?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8dmlvbGluJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"violin music"},{"id":"3","description":"Chopin manuscript","imageUrl":"https://images.unsplash.com/photo-1576325879310-f8d3ad9fa9dc?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTh8fHNoZWV0JTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"sheet music"},{"id":"4","description":"Organ pipes in a cathedral","imageUrl":"https://images.unsplash.com/photo-1600474848954-080e61d18c0d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8b3JnYW58ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"organ bach"},{"id":"5","description":"Classical quartet performance","imageUrl":"https://images.unsplash.com/photo-1492563817904-5f1dc687974f?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8c3RyaW5nJTIwcXVhcnRldHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"string quartet"},{"id":"6","description":"A love letter with a piano","imageUrl":"https://images.unsplash.com/photo-1636740940906-aaa7226ee769?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjJ8fHBpYW5vJTIwbGV0dGVyfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"piano letter"},{"id":"7","description":"Cello leaning against a chair","imageUrl":"https://images.unsplash.com/photo-1612702610868-5c3895fed2ba?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Y2VsbG8lMjBtdXNpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"cello music"},{"id":"8","description":"Flute on a wooden table","imageUrl":"https://images.unsplash.com/photo-1666209932578-668a10a2560c?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Zmx1dGUlMjBjbGFzc2ljfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"flute classic"},{"id":"9","description":"Spanish guitar in warm light","imageUrl":"https://images.unsplash.com/photo-1697196179502-c59ca6f2e947?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Z3VpdGFyJTIwY2xhc3NpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"guitar classic"},{"id":"10","description":"Abstract musical notes","imageUrl":"https://images.unsplash.com/photo-1522008224169-e5992bed5fae?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8bXVzaWMlMjBhYnN0cmFjdHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"music abstract"},{"id":"admin-upload","description":"Admin uploading files","imageUrl":"https://picsum.photos/seed/11/1200/400","imageHint":"file upload"},{"id":"notation-preview","description":"A preview of sheet music notation","imageUrl":"https://picsum.photos/seed/notation1/600/800","imageHint":"sheet music notation"}]}').o},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var i=r(2596),a=r(9688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,i.$)(t))}},9576:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>o});var i=r(5155),a=r(2115);let s=(0,a.createContext)(void 0);async function n(){try{var e;let t=await fetch("/api/auth/me",{cache:"no-store"});return null!=(e=(await t.json()).user)?e:null}catch(e){return null}}function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[l,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{o(await n()),c(!1)})()},[]);let d=async(e,t)=>{if(!t)return!1;try{var r;let i=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!i.ok)return!1;let a=await i.json();return o({id:a.id,email:a.email,name:a.email.split("@")[0],purchaseHistory:null!=(r=a.purchaseHistory)?r:[],role:a.role}),!0}catch(e){return console.error("Error signing in:",e),!1}},u=async(e,t)=>{if(!t)return{success:!1,error:"Password is required."};try{var r;let i=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(201===i.status)return{success:!0};let a=await i.json();return{success:!1,error:null!=(r=null==a?void 0:a.error)?r:"unknown"}}catch(e){return console.error("Error signing up:",e),{success:!1,error:"unknown"}}},p=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),o(null)}catch(e){console.error("Error signing out:",e)}},f=async e=>{if(r)try{await fetch("/api/users/purchases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetMusicId:e})}),o(t=>{if(!t)return null;let r=[...t.purchaseHistory,e];return{...t,purchaseHistory:r}})}catch(e){console.error("Error updating purchase history",e)}};return(0,i.jsx)(s.Provider,{value:{user:r,loading:l,login:d,logout:p,signup:u,addPurchase:f},children:t})}function l(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[102,46,441,684,358],()=>t(3622)),_N_E=e.O()}]);