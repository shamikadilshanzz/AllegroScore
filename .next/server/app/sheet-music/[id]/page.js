(()=>{var e={};e.id=490,e.ids=[490],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10269:(e,t,r)=>{Promise.resolve().then(r.bind(r,42422))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27102:(e,t,r)=>{"use strict";r.d(t,{G:()=>a});let a=JSON.parse('{"o":[{"id":"1","description":"Moonlit piano keys","imageUrl":"https://images.unsplash.com/photo-1635476573973-fdb06ca7ad4d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpYW5vJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"piano music"},{"id":"2","description":"Violin resting on a score","imageUrl":"https://images.unsplash.com/photo-1701749059090-ac8afdba7b44?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8dmlvbGluJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"violin music"},{"id":"3","description":"Chopin manuscript","imageUrl":"https://images.unsplash.com/photo-1576325879310-f8d3ad9fa9dc?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTh8fHNoZWV0JTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"sheet music"},{"id":"4","description":"Organ pipes in a cathedral","imageUrl":"https://images.unsplash.com/photo-1600474848954-080e61d18c0d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8b3JnYW58ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"organ bach"},{"id":"5","description":"Classical quartet performance","imageUrl":"https://images.unsplash.com/photo-1492563817904-5f1dc687974f?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8c3RyaW5nJTIwcXVhcnRldHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"string quartet"},{"id":"6","description":"A love letter with a piano","imageUrl":"https://images.unsplash.com/photo-1636740940906-aaa7226ee769?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjJ8fHBpYW5vJTIwbGV0dGVyfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"piano letter"},{"id":"7","description":"Cello leaning against a chair","imageUrl":"https://images.unsplash.com/photo-1612702610868-5c3895fed2ba?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Y2VsbG8lMjBtdXNpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"cello music"},{"id":"8","description":"Flute on a wooden table","imageUrl":"https://images.unsplash.com/photo-1666209932578-668a10a2560c?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Zmx1dGUlMjBjbGFzc2ljfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"flute classic"},{"id":"9","description":"Spanish guitar in warm light","imageUrl":"https://images.unsplash.com/photo-1697196179502-c59ca6f2e947?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Z3VpdGFyJTIwY2xhc3NpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"guitar classic"},{"id":"10","description":"Abstract musical notes","imageUrl":"https://images.unsplash.com/photo-1522008224169-e5992bed5fae?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8bXVzaWMlMjBhYnN0cmFjdHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"music abstract"},{"id":"admin-upload","description":"Admin uploading files","imageUrl":"https://picsum.photos/seed/11/1200/400","imageHint":"file upload"},{"id":"notation-preview","description":"A preview of sheet music notation","imageUrl":"https://picsum.photos/seed/notation1/600/800","imageHint":"sheet music notation"}]}').o},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},42422:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>en});var a=r(60687),s=r(43210),i=r(16189),n=r(29523),l=r(96834),o=r(44493),d=r(85535),c=r(82614);let m=(0,c.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),u=(0,c.A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),p=(0,c.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var f=r(29867),x=r(6475);let h=(0,x.createServerReference)("70f5b64b17e81a18c62a2574c405e7dd089325d53e",x.callServer,void 0,x.findSourceMapURL,"processPurchase");x.callServer,x.findSourceMapURL;var g=r(11273),b=r(98599),w=r(10991),y=r(70569);s.forwardRef((e,t)=>{let{children:r,...i}=e,n=s.Children.toArray(r),l=n.find(N);if(l){let e=l.props.children,r=n.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,a.jsx)(v,{...i,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,r):null})}return(0,a.jsx)(v,{...i,ref:t,children:r})}).displayName="Slot";var v=s.forwardRef((e,t)=>{let{children:r,...a}=e;if(s.isValidElement(r)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(r=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(r),i=function(e,t){let r={...t};for(let a in t){let s=e[a],i=t[a];/^on[A-Z]/.test(a)?s&&i?r[a]=(...e)=>{i(...e),s(...e)}:s&&(r[a]=s):"style"===a?r[a]={...s,...i}:"className"===a&&(r[a]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}(a,r.props);return r.type!==s.Fragment&&(i.ref=t?(0,b.t)(t,e):e),s.cloneElement(r,i)}return s.Children.count(r)>1?s.Children.only(null):null});v.displayName="SlotClone";var j=({children:e})=>(0,a.jsx)(a.Fragment,{children:e});function N(e){return s.isValidElement(e)&&e.type===j}var M="AlertDialog",[A,D]=(0,g.A)(M,[w.Hs]),H=(0,w.Hs)(),P=e=>{let{__scopeAlertDialog:t,...r}=e,s=H(t);return(0,a.jsx)(w.bL,{...s,...r,modal:!0})};P.displayName=M;var R=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,i=H(r);return(0,a.jsx)(w.l9,{...i,...s,ref:t})});R.displayName="AlertDialogTrigger";var C=e=>{let{__scopeAlertDialog:t,...r}=e,s=H(t);return(0,a.jsx)(w.ZL,{...s,...r})};C.displayName="AlertDialogPortal";var B=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,i=H(r);return(0,a.jsx)(w.hJ,{...i,...s,ref:t})});B.displayName="AlertDialogOverlay";var F="AlertDialogContent",[k,S]=A(F),W=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:i,...n}=e,l=H(r),o=s.useRef(null),d=(0,b.s)(t,o),c=s.useRef(null);return(0,a.jsx)(w.G$,{contentName:F,titleName:U,docsSlug:"alert-dialog",children:(0,a.jsx)(k,{scope:r,cancelRef:c,children:(0,a.jsxs)(w.UC,{role:"alertdialog",...l,...n,ref:d,onOpenAutoFocus:(0,y.m)(n.onOpenAutoFocus,e=>{e.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(j,{children:i}),(0,a.jsx)(O,{contentRef:o})]})})})});W.displayName=F;var U="AlertDialogTitle",z=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,i=H(r);return(0,a.jsx)(w.hE,{...i,...s,ref:t})});z.displayName=U;var q="AlertDialogDescription",_=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,i=H(r);return(0,a.jsx)(w.VY,{...i,...s,ref:t})});_.displayName=q;var Z=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,i=H(r);return(0,a.jsx)(w.bm,{...i,...s,ref:t})});Z.displayName="AlertDialogAction";var G="AlertDialogCancel",I=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,{cancelRef:i}=S(G,r),n=H(r),l=(0,b.s)(t,i);return(0,a.jsx)(w.bm,{...n,...s,ref:l})});I.displayName=G;var O=({contentRef:e})=>{let t=`\`${F}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${F}\` by passing a \`${q}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${F}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return s.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},V=r(4780);let Y=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(B,{className:(0,V.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Y.displayName=B.displayName;let E=s.forwardRef(({className:e,...t},r)=>(0,a.jsxs)(C,{children:[(0,a.jsx)(Y,{}),(0,a.jsx)(W,{ref:r,className:(0,V.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));E.displayName=W.displayName;let $=({className:e,...t})=>(0,a.jsx)("div",{className:(0,V.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});$.displayName="AlertDialogHeader";let T=({className:e,...t})=>(0,a.jsx)("div",{className:(0,V.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});T.displayName="AlertDialogFooter";let J=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(z,{ref:r,className:(0,V.cn)("text-lg font-semibold",e),...t}));J.displayName=z.displayName;let L=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(_,{ref:r,className:(0,V.cn)("text-sm text-muted-foreground",e),...t}));L.displayName=_.displayName;let X=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(Z,{ref:r,className:(0,V.cn)((0,n.r)(),e),...t}));X.displayName=Z.displayName;let K=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(I,{ref:r,className:(0,V.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));K.displayName=I.displayName;var Q=r(18780),ee=r(30474),et=r(27102);function er({className:e,...t}){return(0,a.jsx)("div",{className:(0,V.cn)("animate-pulse rounded-md bg-muted",e),...t})}var ea=r(85814),es=r.n(ea);function ei({item:e}){let[t,r]=(0,s.useTransition)(),{toast:c}=(0,f.dj)(),{user:x,addPurchase:g}=(0,Q.A)(),b=(0,i.useRouter)(),[w,y]=(0,s.useState)(!1),v=et.G.find(t=>t.id===e.imageId),j="number"==typeof e.price?e.price:0,[N,M]=(0,s.useState)(null),A=x?.role==="admin",D=w||A;return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12 mb-8",children:[(0,a.jsx)(o.Zp,{className:"overflow-hidden",children:(0,a.jsxs)(o.Wu,{className:"p-0 relative",children:[(0,a.jsx)("div",{className:"relative aspect-[3/4] w-full",children:(0,a.jsx)(ee.default,{src:v?.imageUrl??"https://picsum.photos/seed/placeholder/600/800",alt:e.title,fill:!0,className:`object-cover transition-all duration-500 ${!D?"blur-lg scale-110":""}`,"data-ai-hint":v?.imageHint})}),!D&&(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center text-center p-4",children:[(0,a.jsx)(d.A,{className:"w-16 h-16 text-primary mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white font-headline",children:"Preview Only"}),(0,a.jsx)("p",{className:"text-white/80",children:"Purchase to unlock and view the full sheet music."})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold font-headline",children:e.title}),(0,a.jsx)("p",{className:"text-2xl text-muted-foreground",children:e.composer}),(0,a.jsx)("div",{className:"flex gap-2 pt-2",children:(0,a.jsx)(l.E,{variant:"secondary",children:e.instrument})})]}),(0,a.jsxs)("div",{className:"mt-auto",children:[D?(0,a.jsx)(n.$,{size:"lg",className:"w-full",asChild:!0,disabled:!e.downloadUrl,children:(0,a.jsxs)(es(),{href:N||"#",target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)(m,{className:"mr-2 h-5 w-5"}),e.downloadUrl?"Download PDF":"Download Not Available"]})}):(0,a.jsxs)(P,{children:[(0,a.jsx)(R,{asChild:!0,children:(0,a.jsx)(n.$,{size:"lg",className:"w-full",disabled:t,children:t?"Processing...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"mr-2 h-5 w-5"}),"Buy Now - $",j.toFixed(2)]})})}),(0,a.jsxs)(E,{children:[(0,a.jsxs)($,{children:[(0,a.jsx)(J,{children:"Confirm Purchase"}),(0,a.jsxs)(L,{children:['You are about to purchase "',e.title,'" for $',j.toFixed(2),"."]})]}),(0,a.jsxs)(T,{children:[(0,a.jsx)(K,{children:"Cancel"}),(0,a.jsx)(X,{onClick:()=>{if(!x){b.push("/login"),c({variant:"destructive",title:"Not Logged In",description:"You must be logged in to make a purchase."});return}r(async()=>{let t=await h(x.id,e.id,e.title);t.success?(g(e.id),c({title:"Purchase Complete!",description:t.message})):c({variant:"destructive",title:"Purchase Failed",description:t.message})})},children:"Continue"})]})]})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-4 text-center flex items-center justify-center gap-2",children:[(0,a.jsx)(p,{className:"w-4 h-4 text-green-500"})," Secure Transaction"]})]})]})]}),N&&(0,a.jsx)(o.Zp,{className:"mt-8",children:(0,a.jsxs)(o.Wu,{className:"p-0",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsx)("h2",{className:"text-2xl font-bold font-headline",children:"Sheet Music Preview"})}),(0,a.jsx)("div",{className:"relative w-full",style:{minHeight:"600px"},children:D?(0,a.jsx)("iframe",{src:N,className:"w-full h-full",style:{minHeight:"600px"},title:"PDF Preview"}):(0,a.jsx)("div",{className:"relative w-full bg-muted",style:{minHeight:"600px"},children:(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-8",children:[(0,a.jsx)(d.A,{className:"w-16 h-16 text-primary mb-4"}),(0,a.jsx)("h3",{className:"text-2xl font-bold font-headline mb-2",children:"Purchase to View PDF"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Unlock this sheet music by purchasing it above."})]})})})]})})]})}function en(){(0,i.useParams)().id;let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0);return r||!e?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[(0,a.jsx)(er,{className:"aspect-[3/4] w-full"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsx)(er,{className:"h-10 w-3/4"}),(0,a.jsx)(er,{className:"h-8 w-1/2"}),(0,a.jsx)(er,{className:"h-6 w-1/4"}),(0,a.jsx)("div",{className:"mt-auto pt-8",children:(0,a.jsx)(er,{className:"h-12 w-full"})})]})]})}):(0,a.jsx)(ei,{item:e})}},44493:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l,wL:()=>m});var a=r(60687),s=r(43210),i=r(4780);let n=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let l=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent";let m=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t}));m.displayName="CardFooter"},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67182:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Programming\\\\AllegroScore\\\\src\\\\app\\\\sheet-music\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Programming\\AllegroScore\\src\\app\\sheet-music\\[id]\\page.tsx","default")},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(31658);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},79551:e=>{"use strict";e.exports=require("url")},85535:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(82614).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},91709:(e,t,r)=>{Promise.resolve().then(r.bind(r,67182))},96834:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var a=r(60687);r(43210);var s=r(24224),i=r(4780);let n=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...r}){return(0,a.jsx)("div",{className:(0,i.cn)(n({variant:t}),e),...r})}},97381:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=r(65239),s=r(48088),i=r(88170),n=r.n(i),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["sheet-music",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,67182)),"D:\\Programming\\AllegroScore\\src\\app\\sheet-music\\[id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"D:\\Programming\\AllegroScore\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["D:\\Programming\\AllegroScore\\src\\app\\sheet-music\\[id]\\page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/sheet-music/[id]/page",pathname:"/sheet-music/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},99412:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"00492daac541d3ad2cb7e829f3d67f6aa655f88bd3":()=>p,"4015146b9814282433eb7b261d859e0ff1b9cc187b":()=>f,"406be1320973afd77a479b23ca26ddefc68fe6e5e7":()=>u,"406fa3e4455bb61e1ba14699a875f2d259d04a36aa":()=>x,"70f5b64b17e81a18c62a2574c405e7dd089325d53e":()=>m});var a=r(91199);r(42087);var s=r(12518);let i=process.env.MONGODB_URI;if(!i)throw Error("MONGODB_URI is not set. Add it to .env.local and restart.");let n=global;async function l(){return n.mongoClientPromise||(n.mongoClientPromise=new s.MongoClient(i).connect()),n.mongoClientPromise}async function o(e=process.env.MONGODB_DB||"allegroscore"){return(await l()).db(e)}async function d(e="files"){let t=await o();return new s.GridFSBucket(t,{bucketName:e})}var c=r(27910);async function m(e,t,r){return console.log(`Processing purchase for ${t} by user ${e}`),await new Promise(e=>setTimeout(e,1500)),console.log(`Purchase successful for ${r}`),{success:!0,message:`Successfully purchased "${r}"!`}}async function u(e){let t=e.get("file"),r=e.get("title"),a=e.get("composer"),s=e.get("instrument"),i=e.get("price"),n=e.get("imageId");if(!t||!r||!a||!s||!i||!n)return{success:!1,message:"Missing required form fields."};try{let e=await d("sheetMusic"),l=`${Date.now()}_${t.name}`,m=e.openUploadStream(l,{contentType:t.type||"application/pdf"}),u=Buffer.from(await t.arrayBuffer());await new Promise((e,t)=>{c.Readable.from(u).pipe(m).on("error",t).on("finish",()=>e())});let p=m.id?.toString(),f=`/api/files/${p}`,x={title:r,composer:a,instrument:s,price:parseFloat(i)||0,imageId:n,downloadUrl:f},h=await o(),g=await h.collection("sheetMusic").insertOne(x);return{success:!0,message:`"${x.title}" has been added with ID: ${g.insertedId.toString()}`}}catch(e){return console.error("Error adding sheet music:",e),{success:!1,message:e.message||"Failed to add sheet music."}}}async function p(){try{let e=await o();return(await e.collection("sheetMusic").find({}).sort({_id:-1}).toArray()).map(e=>({id:e._id.toString(),title:e.title,composer:e.composer,instrument:e.instrument,price:e.price,imageId:e.imageId,downloadUrl:e.downloadUrl}))}catch(e){return console.error("Error fetching sheet music: ",e),[]}}async function f(e){try{let t=await o(),r=await t.collection("sheetMusic").findOne({_id:new s.ObjectId(e)});if(!r)return null;return{id:r._id.toString(),title:r.title,composer:r.composer,instrument:r.instrument,price:r.price,imageId:r.imageId,downloadUrl:r.downloadUrl}}catch(e){return console.error("Error fetching document:",e),null}}async function x(e){if(0===e.length)return[];try{let t=e.map(e=>f(e));return(await Promise.all(t)).filter(e=>null!==e)}catch(e){return console.error("Error fetching purchased music:",e),[]}}(0,r(33331).D)([m,u,p,f,x]),(0,a.A)(m,"70f5b64b17e81a18c62a2574c405e7dd089325d53e",null),(0,a.A)(u,"406be1320973afd77a479b23ca26ddefc68fe6e5e7",null),(0,a.A)(p,"00492daac541d3ad2cb7e829f3d67f6aa655f88bd3",null),(0,a.A)(f,"4015146b9814282433eb7b261d859e0ff1b9cc187b",null),(0,a.A)(x,"406fa3e4455bb61e1ba14699a875f2d259d04a36aa",null)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[719,524,658,706,23],()=>r(97381));module.exports=a})();