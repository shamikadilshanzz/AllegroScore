(()=>{var e={};e.id=63,e.ids=[63],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41841:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>d});var n={};r.r(n),r.d(n,{GET:()=>l});var o=r(96559),s=r(48088),i=r(37719),a=r(75745),u=r(12518);async function l(e,{params:t}){try{let e,r=(await Promise.resolve(t)).id;if(!r)return new Response("File ID is required",{status:400});let n=await (0,a.M)("sheetMusic");try{e=new u.ObjectId(r)}catch(e){return new Response("Invalid file ID",{status:400})}let o=await n.find({_id:e}).toArray();if(0===o.length)return new Response("File not found",{status:404});let s=o[0],i=n.openDownloadStream(e),l=[];await new Promise((e,t)=>{i.on("data",e=>{l.push(e)}),i.on("end",()=>{e()}),i.on("error",e=>{t(e)})});let p=Buffer.concat(l);return new Response(p,{headers:{"Content-Type":s.contentType||"application/pdf","Content-Disposition":`inline; filename="${s.filename||"file.pdf"}"`,"Cache-Control":"public, max-age=31536000, immutable","Content-Length":p.length.toString()}})}catch(e){return console.error("Error serving file:",e),new Response("Internal server error",{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/files/[id]/route",pathname:"/api/files/[id]",filename:"route",bundlePath:"app/api/files/[id]/route"},resolvedPagePath:"D:\\Programming\\AllegroScore\\src\\app\\api\\files\\[id]\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:c,workUnitAsyncStorage:d,serverHooks:f}=p;function m(){return(0,i.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:d})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},75745:(e,t,r)=>{"use strict";r.d(t,{Lf:()=>a,M:()=>u});var n=r(12518);let o=process.env.MONGODB_URI;if(!o)throw Error("MONGODB_URI is not set. Add it to .env.local and restart.");let s=global;async function i(){return s.mongoClientPromise||(s.mongoClientPromise=new n.MongoClient(o).connect()),s.mongoClientPromise}async function a(e=process.env.MONGODB_DB||"allegroscore"){return(await i()).db(e)}async function u(e="files"){let t=await a();return new n.GridFSBucket(t,{bucketName:e})}},78335:()=>{},96487:()=>{},96559:(e,t,r)=>{"use strict";e.exports=r(44870)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[719],()=>r(41841));module.exports=n})();