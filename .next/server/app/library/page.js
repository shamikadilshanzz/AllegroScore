(()=>{var e={};e.id=382,e.ids=[382],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9841:(e,r,t)=>{"use strict";t.d(r,{L:()=>p});var i=t(60687),a=t(30474),s=t(85814),o=t.n(s),n=t(44493),d=t(96834),l=t(27102);function c({item:e}){let r=l.G.find(r=>r.id===e.imageId),t="number"==typeof e.price?e.price:0;return(0,i.jsx)(o(),{href:`/sheet-music/${e.id}`,className:"group",children:(0,i.jsxs)(n.Zp,{className:"h-full overflow-hidden transition-all duration-300 hover:shadow-lg hover:shadow-primary/20 hover:border-primary/50",children:[(0,i.jsx)(n.aR,{className:"p-0",children:(0,i.jsx)("div",{className:"aspect-[3/4] overflow-hidden",children:(0,i.jsx)(a.default,{src:r?.imageUrl??"https://picsum.photos/seed/placeholder/600/800",alt:e.title,width:600,height:800,className:"object-cover w-full h-full transition-transform duration-300 group-hover:scale-105","data-ai-hint":r?.imageHint})})}),(0,i.jsxs)(n.Wu,{className:"p-4",children:[(0,i.jsx)(n.ZB,{className:"text-lg font-headline leading-tight",children:e.title}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.composer})]}),(0,i.jsxs)(n.wL,{className:"p-4 pt-0 flex justify-between items-center",children:[(0,i.jsx)(d.E,{variant:"secondary",children:e.instrument}),(0,i.jsxs)("p",{className:"font-semibold text-lg text-primary",children:["$",t.toFixed(2)]})]})]})})}function p({items:e}){return 0===e.length?(0,i.jsxs)("div",{className:"text-center text-muted-foreground py-16",children:[(0,i.jsx)("p",{className:"text-lg",children:"No sheet music found."}),(0,i.jsx)("p",{children:"Try adjusting your filters."})]}):(0,i.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map(e=>(0,i.jsx)(c,{item:e},e.id))})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10920:(e,r,t)=>{"use strict";t.d(r,{n:()=>a});var i=t(6475);let a=(0,i.createServerReference)("406fa3e4455bb61e1ba14699a875f2d259d04a36aa",i.callServer,void 0,i.findSourceMapURL,"getPurchasedMusic")},12518:e=>{"use strict";e.exports=require("mongodb")},15634:(e,r,t)=>{Promise.resolve().then(t.bind(t,31072))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27102:(e,r,t)=>{"use strict";t.d(r,{G:()=>i});let i=JSON.parse('{"o":[{"id":"1","description":"Moonlit piano keys","imageUrl":"https://images.unsplash.com/photo-1635476573973-fdb06ca7ad4d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fHBpYW5vJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"piano music"},{"id":"2","description":"Violin resting on a score","imageUrl":"https://images.unsplash.com/photo-1701749059090-ac8afdba7b44?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8dmlvbGluJTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"violin music"},{"id":"3","description":"Chopin manuscript","imageUrl":"https://images.unsplash.com/photo-1576325879310-f8d3ad9fa9dc?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTh8fHNoZWV0JTIwbXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"sheet music"},{"id":"4","description":"Organ pipes in a cathedral","imageUrl":"https://images.unsplash.com/photo-1600474848954-080e61d18c0d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8b3JnYW58ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500","imageHint":"organ bach"},{"id":"5","description":"Classical quartet performance","imageUrl":"https://images.unsplash.com/photo-1492563817904-5f1dc687974f?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8c3RyaW5nJTIwcXVhcnRldHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"string quartet"},{"id":"6","description":"A love letter with a piano","imageUrl":"https://images.unsplash.com/photo-1636740940906-aaa7226ee769?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjJ8fHBpYW5vJTIwbGV0dGVyfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"piano letter"},{"id":"7","description":"Cello leaning against a chair","imageUrl":"https://images.unsplash.com/photo-1612702610868-5c3895fed2ba?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Y2VsbG8lMjBtdXNpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"cello music"},{"id":"8","description":"Flute on a wooden table","imageUrl":"https://images.unsplash.com/photo-1666209932578-668a10a2560c?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Zmx1dGUlMjBjbGFzc2ljfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500","imageHint":"flute classic"},{"id":"9","description":"Spanish guitar in warm light","imageUrl":"https://images.unsplash.com/photo-1697196179502-c59ca6f2e947?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8Z3VpdGFyJTIwY2xhc3NpY3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"guitar classic"},{"id":"10","description":"Abstract musical notes","imageUrl":"https://images.unsplash.com/photo-1522008224169-e5992bed5fae?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8bXVzaWMlMjBhYnN0cmFjdHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500","imageHint":"music abstract"},{"id":"admin-upload","description":"Admin uploading files","imageUrl":"https://picsum.photos/seed/11/1200/400","imageHint":"file upload"},{"id":"notation-preview","description":"A preview of sheet music notation","imageUrl":"https://picsum.photos/seed/notation1/600/800","imageHint":"sheet music notation"}]}').o},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31072:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});let i=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Programming\\\\AllegroScore\\\\src\\\\app\\\\library\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Programming\\AllegroScore\\src\\app\\library\\page.tsx","default")},33873:e=>{"use strict";e.exports=require("path")},38394:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var i=t(60687),a=t(9841);t(10920);var s=t(19538),o=t(18780),n=t(16189),d=t(43210);function l(){let{user:e,loading:r}=(0,o.A)();(0,n.useRouter)();let[t,l]=(0,d.useState)([]),[c,p]=(0,d.useTransition)();return r||!e?(0,i.jsx)("div",{className:"container mx-auto px-4 py-8 text-center",children:(0,i.jsx)("p",{children:"Loading..."})}):(0,i.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,i.jsx)(s.A,{className:"w-8 h-8 text-primary"}),(0,i.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"My Library"})]}),(0,i.jsx)("p",{className:"text-muted-foreground mb-8",children:"All your purchased sheet music in one place."}),c?(0,i.jsx)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:(0,i.jsx)("p",{children:"Loading your library..."})}):t.length>0?(0,i.jsx)(a.L,{items:t}):(0,i.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold",children:"Your library is empty"}),(0,i.jsx)("p",{className:"text-muted-foreground mt-2",children:"Start browsing to find your next piece!"})]})]})}},44493:(e,r,t)=>{"use strict";t.d(r,{BT:()=>l,Wu:()=>c,ZB:()=>d,Zp:()=>o,aR:()=>n,wL:()=>p});var i=t(60687),a=t(43210),s=t(4780);let o=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));o.displayName="Card";let n=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...r}));n.displayName="CardHeader";let d=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));d.displayName="CardTitle";let l=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",e),...r}));l.displayName="CardDescription";let c=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent";let p=a.forwardRef(({className:e,...r},t)=>(0,i.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",e),...r}));p.displayName="CardFooter"},55546:(e,r,t)=>{Promise.resolve().then(t.bind(t,38394))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70440:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var i=t(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,i.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},72481:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>l});var i=t(65239),a=t(48088),s=t(88170),o=t.n(s),n=t(30893),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(r,d);let l={children:["",{children:["library",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,31072)),"D:\\Programming\\AllegroScore\\src\\app\\library\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"D:\\Programming\\AllegroScore\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["D:\\Programming\\AllegroScore\\src\\app\\library\\page.tsx"],p={require:t,loadChunk:()=>Promise.resolve()},u=new i.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/library/page",pathname:"/library",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},79551:e=>{"use strict";e.exports=require("url")},96834:(e,r,t)=>{"use strict";t.d(r,{E:()=>n});var i=t(60687);t(43210);var a=t(24224),s=t(4780);let o=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:r,...t}){return(0,i.jsx)("div",{className:(0,s.cn)(o({variant:r}),e),...t})}},99412:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"00492daac541d3ad2cb7e829f3d67f6aa655f88bd3":()=>m,"4015146b9814282433eb7b261d859e0ff1b9cc187b":()=>f,"406be1320973afd77a479b23ca26ddefc68fe6e5e7":()=>u,"406fa3e4455bb61e1ba14699a875f2d259d04a36aa":()=>x,"70f5b64b17e81a18c62a2574c405e7dd089325d53e":()=>p});var i=t(91199);t(42087);var a=t(12518);let s=process.env.MONGODB_URI;if(!s)throw Error("MONGODB_URI is not set. Add it to .env.local and restart.");let o=global;async function n(){return o.mongoClientPromise||(o.mongoClientPromise=new a.MongoClient(s).connect()),o.mongoClientPromise}async function d(e=process.env.MONGODB_DB||"allegroscore"){return(await n()).db(e)}async function l(e="files"){let r=await d();return new a.GridFSBucket(r,{bucketName:e})}var c=t(27910);async function p(e,r,t){return console.log(`Processing purchase for ${r} by user ${e}`),await new Promise(e=>setTimeout(e,1500)),console.log(`Purchase successful for ${t}`),{success:!0,message:`Successfully purchased "${t}"!`}}async function u(e){let r=e.get("file"),t=e.get("title"),i=e.get("composer"),a=e.get("instrument"),s=e.get("price"),o=e.get("imageId");if(!r||!t||!i||!a||!s||!o)return{success:!1,message:"Missing required form fields."};try{let e=await l("sheetMusic"),n=`${Date.now()}_${r.name}`,p=e.openUploadStream(n,{contentType:r.type||"application/pdf"}),u=Buffer.from(await r.arrayBuffer());await new Promise((e,r)=>{c.Readable.from(u).pipe(p).on("error",r).on("finish",()=>e())});let m=p.id?.toString(),f=`/api/files/${m}`,x={title:t,composer:i,instrument:a,price:parseFloat(s)||0,imageId:o,downloadUrl:f},h=await d(),g=await h.collection("sheetMusic").insertOne(x);return{success:!0,message:`"${x.title}" has been added with ID: ${g.insertedId.toString()}`}}catch(e){return console.error("Error adding sheet music:",e),{success:!1,message:e.message||"Failed to add sheet music."}}}async function m(){try{let e=await d();return(await e.collection("sheetMusic").find({}).sort({_id:-1}).toArray()).map(e=>({id:e._id.toString(),title:e.title,composer:e.composer,instrument:e.instrument,price:e.price,imageId:e.imageId,downloadUrl:e.downloadUrl}))}catch(e){return console.error("Error fetching sheet music: ",e),[]}}async function f(e){try{let r=await d(),t=await r.collection("sheetMusic").findOne({_id:new a.ObjectId(e)});if(!t)return null;return{id:t._id.toString(),title:t.title,composer:t.composer,instrument:t.instrument,price:t.price,imageId:t.imageId,downloadUrl:t.downloadUrl}}catch(e){return console.error("Error fetching document:",e),null}}async function x(e){if(0===e.length)return[];try{let r=e.map(e=>f(e));return(await Promise.all(r)).filter(e=>null!==e)}catch(e){return console.error("Error fetching purchased music:",e),[]}}(0,t(33331).D)([p,u,m,f,x]),(0,i.A)(p,"70f5b64b17e81a18c62a2574c405e7dd089325d53e",null),(0,i.A)(u,"406be1320973afd77a479b23ca26ddefc68fe6e5e7",null),(0,i.A)(m,"00492daac541d3ad2cb7e829f3d67f6aa655f88bd3",null),(0,i.A)(f,"4015146b9814282433eb7b261d859e0ff1b9cc187b",null),(0,i.A)(x,"406fa3e4455bb61e1ba14699a875f2d259d04a36aa",null)}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[719,524,658,706,23],()=>t(72481));module.exports=i})();